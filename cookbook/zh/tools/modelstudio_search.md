# æœç´¢ç»„ä»¶ (Searches)

æœ¬ç›®å½•åŒ…å«å„ç§æœç´¢æœåŠ¡ç»„ä»¶ï¼Œæä¾›æ™ºèƒ½æœç´¢ã€ä¿¡æ¯æ£€ç´¢å’Œå†…å®¹å‘ç°åŠŸèƒ½ã€‚

## ğŸ“‹ ç»„ä»¶åˆ—è¡¨

### 1. ModelstudioSearch - ç™¾ç‚¼æœç´¢ç»„ä»¶
æ ¸å¿ƒçš„æ™ºèƒ½æœç´¢æœåŠ¡ï¼Œæ”¯æŒå¤šç§æœç´¢ç­–ç•¥å’Œä¿¡æ¯æºã€‚

**å‰ç½®ä½¿ç”¨æ¡ä»¶ï¼š**

- æœ‰æ•ˆçš„DashScope APIå¯†é’¥ï¼Œ **è¯¥ç»„ä»¶ç›®å‰å±äºè¦é‚€æµ‹é˜¶æ®µï¼Œè¯·è”ç³»å¼€å‘è€…ï¼Œå¹¶æä¾›DASHSCOPE_API_KEY**
- é…ç½®æœç´¢æœåŠ¡ç­–ç•¥
- ç½‘ç»œè¿æ¥ç¨³å®š

**è¾“å…¥å‚æ•° (SearchInput)ï¼š**
- `messages` (List): æœç´¢ç›¸å…³çš„å¯¹è¯æ¶ˆæ¯
- `search_options` (Dict): æœç´¢é€‰é¡¹é…ç½®
  - `search_strategy`: æœç´¢ç­–ç•¥ï¼ˆwebã€newsã€academicç­‰ï¼‰
  - `max_results`: æœ€å¤§æœç´¢ç»“æœæ•°é‡
  - `time_range`: æ—¶é—´èŒƒå›´é™åˆ¶
  - `language`: æœç´¢è¯­è¨€
  - `region`: åœ°ç†åŒºåŸŸé™åˆ¶
- `search_output_rules` (Dict): è¾“å‡ºæ ¼å¼è§„åˆ™
- `search_timeout` (int): æœç´¢è¶…æ—¶æ—¶é—´
- `type` (str): æœç´¢ç±»å‹

**è¾“å‡ºå‚æ•° (SearchOutput)ï¼š**
- `search_result` (str): æœç´¢ç»“æœæ‘˜è¦
- `search_info` (Dict): è¯¦ç»†æœç´¢ä¿¡æ¯
  - `sources`: ä¿¡æ¯æ¥æºåˆ—è¡¨
  - `relevance_score`: ç›¸å…³æ€§è¯„åˆ†
  - `search_time`: æœç´¢ç”¨æ—¶
  - `result_count`: ç»“æœæ•°é‡

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- **æ™ºèƒ½æœç´¢**: åŸºäºè¯­ä¹‰ç†è§£çš„æ™ºèƒ½æœç´¢
- **å¤šæºæ•´åˆ**: æ•´åˆå¤šä¸ªä¿¡æ¯æºçš„æœç´¢ç»“æœ
- **å®æ—¶æœç´¢**: è·å–æœ€æ–°çš„å®æ—¶ä¿¡æ¯
- **ç»“æœè¿‡æ»¤**: åŸºäºç›¸å…³æ€§å’Œè´¨é‡çš„ç»“æœç­›é€‰
- **æœç´¢ä¼˜åŒ–**: è‡ªåŠ¨ä¼˜åŒ–æœç´¢æŸ¥è¯¢å’Œç­–ç•¥

### 2. ModelstudioSearchLite - ç™¾ç‚¼æœç´¢è½»é‡ç‰ˆ
æä¾›è½»é‡åŒ–çš„æœç´¢åŠŸèƒ½ï¼Œé€‚åˆå¿«é€ŸæŸ¥è¯¢å’Œèµ„æºå—é™åœºæ™¯ã€‚

**å‰ç½®ä½¿ç”¨æ¡ä»¶ï¼š**
- å‰å¾€ [ç™¾ç‚¼æœç´¢](https://bailian.console.aliyun.com/?tab=mcp#/mcp-market/detail/WebSearch) è¿›è¡Œå¼€é€š
- è¾ƒä½çš„ç½‘ç»œå»¶è¿Ÿè¦æ±‚

**ä¸»è¦ç‰¹ç‚¹ï¼š**
- æ›´å¿«çš„å“åº”é€Ÿåº¦
- è¾ƒä½çš„èµ„æºæ¶ˆè€—
- ç®€åŒ–çš„æœç´¢é€‰é¡¹
- é€‚åˆç§»åŠ¨ç«¯åº”ç”¨

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

| ç¯å¢ƒå˜é‡ | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜ |
|---------|------|--------|------|
| `DASHSCOPE_API_KEY` | âœ… | - | DashScope APIå¯†é’¥ |
| `SEARCH_DEFAULT_STRATEGY` | âŒ | web | é»˜è®¤æœç´¢ç­–ç•¥ |
| `SEARCH_MAX_RESULTS` | âŒ | 10 | é»˜è®¤æœ€å¤§æœç´¢ç»“æœæ•° |
| `SEARCH_TIMEOUT` | âŒ | 30 | æœç´¢è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| `SEARCH_ENABLE_CACHE` | âŒ | true | æ˜¯å¦å¯ç”¨æœç´¢ç¼“å­˜ |
| `SEARCH_REGION` | âŒ | global | é»˜è®¤æœç´¢åŒºåŸŸ |

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€æœç´¢ç¤ºä¾‹

```python
from agentscope_runtime.tools.searches import ModelstudioSearch
import asyncio

# åˆå§‹åŒ–æœç´¢ç»„ä»¶
search = ModelstudioSearch()


async def basic_search_example():
    result = await search.arun({
        "messages": [
            {"role": "user", "content": "æœ€æ–°çš„äººå·¥æ™ºèƒ½å‘å±•è¶‹åŠ¿"}
        ],
        "search_options": {
            "search_strategy": "news",
            "max_results": 5,
            "time_range": "last_month",
            "language": "zh-CN"
        },
        "search_timeout": 20
    })

    print("æœç´¢ç»“æœæ‘˜è¦:", result.search_result)
    print("ä¿¡æ¯æ¥æº:", result.search_info["sources"])


asyncio.run(basic_search_example())
```

### å¤šç­–ç•¥æœç´¢ç¤ºä¾‹

```python
async def multi_strategy_search_example():
    # å­¦æœ¯æœç´¢
    academic_result = await search.arun({
        "messages": [
            {"role": "user", "content": "æ·±åº¦å­¦ä¹ åœ¨åŒ»ç–—è¯Šæ–­ä¸­çš„åº”ç”¨"}
        ],
        "search_options": {
            "search_strategy": "academic",
            "max_results": 10,
            "language": "en"
        }
    })

    # æ–°é—»æœç´¢
    news_result = await search.arun({
        "messages": [
            {"role": "user", "content": "äººå·¥æ™ºèƒ½æœ€æ–°æ”¿ç­–"}
        ],
        "search_options": {
            "search_strategy": "news",
            "time_range": "last_week",
            "region": "china"
        }
    })

    print("å­¦æœ¯æœç´¢ç»“æœ:", academic_result.search_result)
    print("æ–°é—»æœç´¢ç»“æœ:", news_result.search_result)


asyncio.chat(multi_strategy_search_example())
```

### é«˜çº§æœç´¢é…ç½®ç¤ºä¾‹

```python
async def advanced_search_example():
    result = await search.arun({
        "messages": [
            {"role": "user", "content": "æ¯”è¾ƒä¸åŒæœºå™¨å­¦ä¹ ç®—æ³•çš„æ€§èƒ½"},
            {"role": "assistant", "content": "æˆ‘æ¥ä¸ºæ‚¨æœç´¢ç›¸å…³çš„å¯¹æ¯”ä¿¡æ¯"},
            {"role": "user", "content": "é‡ç‚¹å…³æ³¨å‡†ç¡®ç‡å’Œæ•ˆç‡"}
        ],
        "search_options": {
            "search_strategy": "comprehensive",
            "max_results": 15,
            "filters": {
                "content_type": ["article", "paper", "report"],
                "quality_threshold": 0.8,
                "exclude_domains": ["low-quality-site.com"]
            },
            "ranking_criteria": ["relevance", "authority", "freshness"]
        },
        "search_output_rules": {
            "include_citations": True,
            "summarize_results": True,
            "highlight_key_points": True
        }
    })

    print("ç»¼åˆæœç´¢ç»“æœ:", result.search_result)
    print("æœç´¢ç»Ÿè®¡:", result.search_info)


asyncio.chat(advanced_search_example())
```

## ğŸ” æ”¯æŒçš„æœç´¢ç­–ç•¥

### Webæœç´¢
- **é€šç”¨ç½‘é¡µæœç´¢**: æœç´¢æ•´ä¸ªäº’è”ç½‘çš„ç½‘é¡µå†…å®¹
- **å®æ—¶æœç´¢**: è·å–æœ€æ–°å‘å¸ƒçš„ç½‘é¡µä¿¡æ¯
- **æ·±åº¦æœç´¢**: å¤šå±‚æ¬¡çš„å†…å®¹æŒ–æ˜å’Œåˆ†æ

### ä¸“ä¸šæœç´¢
- **å­¦æœ¯æœç´¢**: æœç´¢å­¦æœ¯è®ºæ–‡ã€ç ”ç©¶æŠ¥å‘Š
- **æ–°é—»æœç´¢**: æœç´¢æ–°é—»æŠ¥é“ã€æ—¶äº‹ä¿¡æ¯
- **æŠ€æœ¯æœç´¢**: æœç´¢æŠ€æœ¯æ–‡æ¡£ã€APIå‚è€ƒ
- **äº§å“æœç´¢**: æœç´¢äº§å“ä¿¡æ¯ã€ç”¨æˆ·è¯„ä»·

### å¤šåª’ä½“æœç´¢
- **å›¾ç‰‡æœç´¢**: åŸºäºæè¿°æœç´¢ç›¸å…³å›¾ç‰‡
- **è§†é¢‘æœç´¢**: æœç´¢ç›¸å…³è§†é¢‘å†…å®¹
- **æ–‡æ¡£æœç´¢**: æœç´¢PDFã€Wordç­‰æ–‡æ¡£

## ğŸ—ï¸ æœç´¢æ¶æ„

### æŸ¥è¯¢å¤„ç†
1. **æŸ¥è¯¢ç†è§£**: åˆ†æç”¨æˆ·æŸ¥è¯¢æ„å›¾å’Œå…³é”®ä¿¡æ¯
2. **æŸ¥è¯¢æ‰©å±•**: æ·»åŠ åŒä¹‰è¯ã€ç›¸å…³è¯æ±‡
3. **æŸ¥è¯¢ä¼˜åŒ–**: ä¼˜åŒ–æœç´¢æŸ¥è¯¢ä»¥æé«˜å‡†ç¡®æ€§
4. **å¤šç­–ç•¥è·¯ç”±**: æ ¹æ®æŸ¥è¯¢ç±»å‹é€‰æ‹©æœ€ä½³æœç´¢ç­–ç•¥

### ç»“æœå¤„ç†
1. **ç»“æœèšåˆ**: æ•´åˆå¤šä¸ªæœç´¢æºçš„ç»“æœ
2. **å»é‡å¤„ç†**: åˆ é™¤é‡å¤å’Œç›¸ä¼¼çš„ç»“æœ
3. **è´¨é‡è¯„ä¼°**: è¯„ä¼°ç»“æœçš„è´¨é‡å’Œå¯ä¿¡åº¦
4. **ç›¸å…³æ€§æ’åº**: æŒ‰ç›¸å…³æ€§å¯¹ç»“æœè¿›è¡Œæ’åº
5. **å†…å®¹æ‘˜è¦**: ç”Ÿæˆç»“æœæ‘˜è¦å’Œå…³é”®ç‚¹

### ç¼“å­˜æœºåˆ¶
- **æŸ¥è¯¢ç¼“å­˜**: ç¼“å­˜å¸¸è§æŸ¥è¯¢çš„ç»“æœ
- **ç»“æœç¼“å­˜**: ç¼“å­˜é«˜è´¨é‡çš„æœç´¢ç»“æœ
- **æ™ºèƒ½æ›´æ–°**: æ ¹æ®å†…å®¹æ—¶æ•ˆæ€§è‡ªåŠ¨æ›´æ–°ç¼“å­˜

## ğŸ“Š æœç´¢ä¼˜åŒ–

### æ€§èƒ½ä¼˜åŒ–
- **å¹¶è¡Œæœç´¢**: åŒæ—¶æŸ¥è¯¢å¤šä¸ªä¿¡æ¯æº
- **ç»“æœé¢„å–**: é¢„å–å¯èƒ½ç›¸å…³çš„æœç´¢ç»“æœ
- **æ™ºèƒ½ç¼“å­˜**: åŸºäºç”¨æˆ·è¡Œä¸ºçš„æ™ºèƒ½ç¼“å­˜ç­–ç•¥
- **è´Ÿè½½å‡è¡¡**: åˆ†æ•£æœç´¢è¯·æ±‚åˆ°ä¸åŒæœåŠ¡èŠ‚ç‚¹

### è´¨é‡æ§åˆ¶
- **æ¥æºå¯ä¿¡åº¦è¯„ä¼°**: è¯„ä¼°ä¿¡æ¯æ¥æºçš„å¯ä¿¡åº¦
- **å†…å®¹è´¨é‡æ£€æŸ¥**: æ£€æŸ¥å†…å®¹çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§
- **æ—¶æ•ˆæ€§éªŒè¯**: éªŒè¯ä¿¡æ¯çš„æ—¶æ•ˆæ€§
- **åè§æ£€æµ‹**: æ£€æµ‹å’Œæ ‡è®°å¯èƒ½å­˜åœ¨åè§çš„å†…å®¹

## ğŸ“¦ ä¾èµ–åŒ…
- `aiohttp`: å¼‚æ­¥HTTPå®¢æˆ·ç«¯
- `dashscope`: DashScope SDK
- `beautifulsoup4`: HTMLè§£æ
- `lxml`: XML/HTMLå¤„ç†
- `nltk`: è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆå¯é€‰ï¼‰
- `elasticsearch`: æœç´¢å¼•æ“ï¼ˆå¯é€‰ï¼‰

## âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹

### æœç´¢ç­–ç•¥é€‰æ‹©
- æ ¹æ®æŸ¥è¯¢ç±»å‹é€‰æ‹©åˆé€‚çš„æœç´¢ç­–ç•¥
- è€ƒè™‘ç»“æœçš„æ—¶æ•ˆæ€§éœ€æ±‚
- å¹³è¡¡æœç´¢æ·±åº¦å’Œå“åº”é€Ÿåº¦
- æ ¹æ®ç”¨æˆ·åœºæ™¯è°ƒæ•´æœç´¢å‚æ•°

### ç»“æœè´¨é‡ç®¡ç†
- è®¾ç½®åˆé€‚çš„ç›¸å…³æ€§é˜ˆå€¼
- éªŒè¯æœç´¢ç»“æœçš„å‡†ç¡®æ€§
- å¤„ç†æœç´¢ç»“æœä¸è¶³çš„æƒ…å†µ
- å»ºç«‹ç”¨æˆ·åé¦ˆæœºåˆ¶æ”¹è¿›æœç´¢è´¨é‡

### APIä½¿ç”¨é™åˆ¶
- éµå®ˆæœç´¢æœåŠ¡çš„è°ƒç”¨é¢‘ç‡é™åˆ¶
- åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´é¿å…é•¿æ—¶é—´ç­‰å¾…
- å®ç°é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ç›‘æ§APIä½¿ç”¨é‡å’Œæˆæœ¬

## ğŸ”— ç›¸å…³ç»„ä»¶
- å¯ä¸RAGç»„ä»¶ç»“åˆï¼Œæä¾›æ£€ç´¢å¢å¼ºç”Ÿæˆ
- æ”¯æŒä¸æ„å›¾è¯†åˆ«ç»„ä»¶é›†æˆï¼Œå®ç°æ™ºèƒ½æœç´¢è·¯ç”±
- å¯ä¸å†…å­˜ç»„ä»¶é…åˆï¼Œè®°å½•ç”¨æˆ·æœç´¢å†å²
- æ”¯æŒä¸æ’ä»¶ç³»ç»Ÿé›†æˆï¼Œæ‰©å±•ç‰¹å®šé¢†åŸŸæœç´¢